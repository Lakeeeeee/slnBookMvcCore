@{
    ViewData["Title"] = "中文書";
}
<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/prjBookMvcCore.styles.css" asp-append-version="true" />
    <style>
        a:link, a:visited {
            text-decoration: none;
            color: inherit;
        }

        .font14px {
            font-size: 14px
        }

        .fontClean {
            text-decoration: none;
            color: inherit;
        }

        .accordion-button {
            background-color: #eeeeee;
            min-height: 15px
        }

            .accordion-button:active, .accordion-button::backdrop, .accordion-button:is(:hover) {
                background-color: #ffffff;
            }

            .accordion-button:not(.collapsed) {
                background-color: #eeeeee;
                color: inherit;
            }

        .layoutList, .layoutGrid {
            width: 6%;
            height: 6%;
        }
    </style>
    <script src="~/Scripts/modernizr-2.8.3.js"></script>
</head>
<body>
    <nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a class="linkaFormat" href="~/Home/Home">首頁</a></li>
            <li class="breadcrumb-item"><a class="linkaFormat" href="~/Home/Menu">書籍</a></li>
            <li class="breadcrumb-item active" aria-current="page">中文書</li>
        </ol>
    </nav>

    <div class="container" style="margin-top: 20px">
        <div class="row">
            @* 左邊功能欄 *@
            <div class="col-2">
                <div class="card">
                    @* 中文書分類 *@
                    <div class="card-header">
                        中文書
                    </div>
                    <div>
                        <ul class="list-group list-group-flush">
                            @{
                                BookShopContext db = new BookShopContext();
                                var c = db.Categories.Select(a => new { a.CategoryId, a.CategoryName });
                                foreach (var g in c)
                                {
                                    <li class="list-group-item"><span><a href="~/Category/@g.CategoryName">@g.CategoryName</a></span></li>
                                }
                            }
                        </ul>
                    </div>
                </div>
            </div>
            @* 右邊書籍欄 *@
            <div class="col-10">
                @*排序欄*@
                <div class="row">
                    <div class="col">
                        <div style="float:right">
                            <span>排序方式</span>
                            <div class="btn-group">
                                <select class="form-select" aria-label="Default select example">
                                    <option selected>暢銷度排序</option>
                                    <option value="1">出版日期排序</option>
                                    <option value="2">價格排序</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col" id="listView" style='padding:0'>
                        <div class="row">
                            @{
                                //var pageSize = 30; // 每頁顯示30筆資料
                                //var categorydetail = db.CategoryDetails.Where(c => c.SubCategoryId == 17).Select(c => new { c.BookId }).ToList();
                                //int pageIndex = 0;
                                //do
                                //{
                                //    var pageBooks = categorydetail.Skip(pageIndex * pageSize).Take(pageSize);
                                //    if (pageBooks.Any())
                                //    {
                                //        foreach (var categoryBook in pageBooks)
                                //        {
                                //            // ... 程式碼沒變 ...
                                //        }
                                //        pageIndex++;
                                //    }
                                //    else
                                //    {
                                //        break; // 沒有更多資料了，結束迴圈
                                //    }
                                //} while (true);
                                var categorydetail = db.CategoryDetails.Where(c => c.SubCategoryId == c.SubCategoryId).Select(c => new { c.BookId }).ToList();
                                foreach (var categoryBook in categorydetail)
                                {
                                    //var discounnt = db.DiscountDetails.Where(d => d.BookId == categoryBook.BookId).Select(d => new { d.DiscountId }).ToList();
                                    //foreach (var discountId in discounnt)
                                    //{
                                    //    var discountName = db.Discounts.Where(d => d.DiscountId == discountId.DiscountId).Select(d => new { d.DiscountId, d.DiscountName, d.DiscounDescription, d.DiscountAmount }).ToList();
                                    //    foreach (var book in discountName)
                                    //    {
                                    var author = db.AuthorDetails.Where(a => a.BookId == categoryBook.BookId).Select(a => new { a.AuthorId }).ToList();
                                    foreach (var authorId in author)
                                    {
                                        var authorName = db.Authors.Where(a => a.AuthorId == authorId.AuthorId).Select(a => new { a.AuthorId, a.AuthorName }).ToList();
                                        foreach (var book in authorName)
                                        {
                                            var bookViewlis = db.Books.Where(b => b.BookId == categoryBook.BookId).Select(b => new { b.BookId, b.BookTitle, b.PublicationDate, b.UnitPrice, b.CoverPath }).ToList();
                                            if (bookViewlis != null)
                                            {
                                                foreach (var bookview in bookViewlis)
                                                {
                                                    @*第一組*@
                                                    <div class="col" srl="">
                                                        @*圖片*@<div style="position:relative">
                                                            <a>@bookview.CoverPath</a>
                                                        </div>
                                                        <div class="caption bookCaption">
                                                            <ul style="list-style:none; margin:0; padding:0;">
                                                                <li class='prod_TitleMain'>
                                                                    <a>
                                                                        @bookview.BookTitle
                                                                    </a>
                                                                </li>
                                                                <li class='prod_author'>作者：<a href='/rwd_searchResult.html?keyword%5B%5D=LiveABC編輯群&keyType%5B%5D=2'>@book.AuthorName</a></li>
                                                                <li class="Price">原    價：<span>@((int)Math.Round(bookview.UnitPrice))</span>元</li>
                                                                <li class="discPrice">優惠價：<span>     </span><span>@((int)Math.Round(bookview.UnitPrice))</span>元</li>
                                                                <li class="publicationDate">出版日期：<span>@bookview.PublicationDate.ToString("yyyy/MM/dd")</span></li>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                }
                                            }
                                        }
                                    }
                                    //    }
                                    //}
                                }
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
        @* <nav aria-label="Page navigation example">
        <div class="row">
        <!-- Display books -->
        </div>
        <ul class="pagination">
        @if (Model.TotalPages > 1)
        {
        <!-- Display previous page link -->
        <li class="page-item @(Model.CurrentPage == 1 ? "disabled" : "")">
        <a class="page-link" href="@Url.Action("Index", new { page = Model.CurrentPage - 1 })">Previous</a>
        </li>

        <!-- Generate page links -->
        @for (int i = 1; i <= Model.TotalPages; i++)
        {
        <li class="page-item @(Model.CurrentPage == i ? "active" : "")">
        <a class="page-link" href="@Url.Action("Index", new { page = i })">@i</a>
        </li>
        }

        <!-- Display next page link -->
        <li class="page-item @(Model.CurrentPage == Model.TotalPages ? "disabled" : "")">
        <a class="page-link" href="@Url.Action("Index", new { page = Model.CurrentPage + 1 })">Next</a>
        </li>
        }
        </ul>
        </nav>*@
    </div>


    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
</body>
</html>

