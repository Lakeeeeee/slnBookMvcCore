@model IEnumerable<prjBookMvcCore.Models.Book>

@{
    ViewData["Title"] = "myCollect";
    Layout = "~/Views/Shared/_Layout_Member.cshtml";
}

<div class="container" style="margin-top:15px">
    <div>
        <nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="~/Member/MemberCenter">會員中心</a></li>
                <li class="breadcrumb-item active" aria-current="page">暫存清單</li>
            </ol>
        </nav>
    </div>
    <p><h6>暫存清單</h6></p>
    <table class="table table-hover">
        <tr>
            <th>序號</th>
            <th>書名</th>
            <th>優惠</th>
            <th>優惠價</th>
            <th>出版社</th>
            <th>庫存</th>
        </tr>

        @{
            int count = 0;
            foreach (var item in Model)
            {
                count++;
                <tr>
                    <td>
                        @count
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.BookTitle)
                    </td>
                    <td>
                        @{
                            string 活動 = "無優惠活動";
                            if (item.DiscountDetails.FirstOrDefault() != null)
                            {
                                活動 = item.DiscountDetails.Select(x => x.Discount.DiscountName).FirstOrDefault().ToString();
                            }
                        }
                        @Html.DisplayFor(modelItem => 活動)
                    </td>
                    <td>
                        @{
                            decimal 折扣 = 1;
                            if (item.DiscountDetails.FirstOrDefault() != null)
                            {
                                折扣 = Convert.ToDecimal(item.DiscountDetails.Select(x => x.Discount.DiscountAmount));
                            }
                            var 活動價 = item.UnitPrice * 折扣;
                        }

                        @Html.DisplayFor(modelItem => 活動價)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Publisher.PublisherName)
                    </td>
                    <td>
                        @{
                            string 供貨狀況 = item.UnitInStock > 0 ? "可供貨" : "缺貨";
                        }
                        @Html.DisplayFor(modelItem => 供貨狀況)
                    </td>

                    <td>
                        @Html.ActionLink("刪除", "Delete", new { id = item.BookId }, new { onclick = "return confirm('確定要刪除嗎?')" })
                    </td>
                </tr>
            }
        }
    </table>

</div>
